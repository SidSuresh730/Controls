syms Ra La Kt Kv Bm;
Ra = 1;
La = .001;
Kt = 5;
Kv = 5;
Bm = 20;
J = 1;
A = [-Ra/La -Kv/La 0; Kt/J -Bm/J 0; 0 1 0];
B = [1/La; 0; 0];
C = [0 0 1];
[num, den] = ss2tf(A, B, C, 0);
Gs = tf(num, den);
pzmap(Gs),grid;
% values from Simulink PID tuning %
Kp = 192.081141761105;
Ki = 618.942083953715;
Kd = 1.4170706434817;
N = 20.9842185158897;
Hs = Kp + Ki*tf(1,[1 0]) + Kd*N/(1+N*tf(1, [1 0]));
Lg = Gs*Hs;
Ts = feedback(Lg, 1);
figure(1);
step(feedback(Gs, 1)), grid;
figure(2);
step(Ts), grid;
figure(3);
pzmap(Ts), grid;
figure(4);
margin(Ts), grid;
